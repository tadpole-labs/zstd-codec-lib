class t{t;i;h;o;m;u;l;_=0;S=0;p=0;A=0;P=0;U=0;D=0;$=0;constructor(t={}){this.l={dictionary:t.dictionary,maxSrcSize:t.maxSrcSize||0,maxDstSize:t.maxDstSize||0}}init(t){let i=new WebAssembly.Instance(t,{env:{}});if(this.t=i,this.i=i.exports,this.h=i.exports.memory,this.o=new Uint8Array(this.h.buffer),this.m=new Uint32Array(this.h.buffer),this.u=new DataView(this.h.buffer),this._=this.i.createDCtx(),this.l.dictionary){if(this.l.dictionary.length>2097152)throw Error("dict>2mb max size");this.S=this.v(this.l.dictionary)}return this.P=this.H(24),this.U=this.P+12,this.D=1048576,this.$=8388608,this.p=this.H(this.D),this.A=this.p+this.D,this}H(t){return this.i.bmalloc(t)}decompressSync(t,i){if(!this.i)throw Error("module not initialized");let s=t.length;if(s>this.l.maxSrcSize)throw Error(`comp data ${s}b>maxSrcSize lim ${this.l.maxSrcSize}b)`);if(!i||i>8388608)return this.decompressStream(t,!0).buf;this.o.set(t,this.p);let r=this.i._decompressSync(this._,this.A,this.$,this.p,s,this.S||0);if(this.M(r))throw Error("decomp failed err "+r);return this.o.slice(this.A,this.A+r)}M(t){return 0!==this.i.isError(t)}W(t,i,s,r=0){let h=t>>>2;this.m[h]=i,this.m[h+1]=s,this.m[h+2]=r}I(t){return this.m[t+8>>>2]}decompressStream(t,i=!1){if(!this.i)throw Error("WASM module not initialized");if(i&&(this.i.reset(this._),this.S&&this.i.refDict(this._,this.S),this.i.prune_buf(this.A)),!t||0===t.length)return{buf:new Uint8Array(0),code:0,in_offset:0};let s=[],r=0,h=0,e=131075,o=this.p+e;for(;t.length>h;){let i=Math.min(t.length-h,131075);for(this.o.set(t.subarray(h,h+i),this.p),this.W(this.P,this.p,i,0);this.I(this.P)<i;){this.W(this.U,o,131072,0);let t=this.i.decStream(this._,this.U,this.P);if(this.M(t))throw Error("decomp err "+t);let i=this.I(this.U);if(i>0){if(r+=i,r>this.l.maxDstSize)throw Error(`decomp size ${r}b>maxDstSize lim ${this.l.maxDstSize}b`);s.push(this.o.slice(o,o+i))}t>0&&131075>t&&(e=t)}h+=i}return{buf:this.O(s),code:0,in_offset:t.length}}O(t){let i=new Uint8Array(t.reduce((t,i)=>t+i.length,0)),s=0;for(let r of t)i.set(r,s),s+=r.length;return i}v(t){let i=this.H(t.length);return this.o.set(t,i),this.i.createDict(i,t.length)}}var i=t;export{i as default,t as ZstdDecoder};